<html>
<body>
	<canvas id="folha" width="600" height="500"></canvas>
	<script>
		//carrega os primeiros comandos
		window.onload = function() {
			iniciar(); //inicializa as variáveis globais e os comandos
			setInterval(principal, 1000/150); //roda o jogo
		}

		function iniciar (){
			 folhaDesenho = document.getElementById("folha");
			 areaDesenho = folhaDesenho.getContext("2d");
			 larguraCampo = 600;
			 alturaCampo = 500;
			 espessuraRede = 5;
			 diametroBola = 10;
			 espessuraRaquete = 11;
			 alturaRaquete = 100;
			 velocidadeJogador2 = 2;
			 efeitoRaquete = 0.3;
			 jogador1 = jogador2 = 0;
			 posicaoJogador1 = posicaoJogador2 = 40;
			 posicaoBolaX = posicaoBolaY = 10;
			 velocidadeBolaPosicaoX = velocidadeBolaPosicaoY = 3;

			folhaDesenho.addEventListener('mousemove', function(e){
				posicaoJogador1 = e.clientY - alturaRaquete / 2;
			});
		}

		function continuar (){
			posicaoBolaX = larguraCampo / 2;
			posicaoBolaY = alturaCampo /2;
			velocidadeBolaPosicaoX = -velocidadeBolaPosicaoX;
			velocidadeBolaPosicaoY = 3;
		}

		function desenhar (){

		// Campo
		areaDesenho.fillStyle = "#6666ff"; // cor azul claro

		areaDesenho.fillRect(0, 0, larguraCampo, alturaCampo);

		areaDesenho.fillStyle = "#ffffff" // cor branca

		// Rede 
		areaDesenho.fillRect(larguraCampo / 2 - espessuraRede / 2, 0, espessuraRede, alturaCampo)

		// Bola
		areaDesenho.fillRect(posicaoBolaX - diametroBola / 2, posicaoBolaY - diametroBola, diametroBola, diametroBola)

		// Raquete
		areaDesenho.fillRect(0, posicaoJogador1, espessuraRaquete, alturaRaquete);
		areaDesenho.fillRect(larguraCampo - espessuraRaquete, posicaoJogador2, espessuraRaquete, alturaRaquete);

		// Escrever a pontuação dos jogadores
		areaDesenho.fillText("Jogador 1: " + jogador1 + " pontos", 100, 100);
		areaDesenho.fillText("Computador: " + jogador2 + " pontos", larguraCampo - 200, 100);
		}

		function calcular(){

		posicaoBolaX = posicaoBolaX + velocidadeBolaPosicaoX;
		posicaoBolaY = posicaoBolaY + velocidadeBolaPosicaoY;

		// Verifica lateral superior
		if (posicaoBolaY < 0 && velocidadeBolaPosicaoY < 0){
			velocidadeBolaPosicaoY = -velocidadeBolaPosicaoY;
		}

		// Verifica a lateral inferior
		if (posicaoBolaY > alturaCampo && velocidadeBolaPosicaoY > 0){
			velocidadeBolaPosicaoY = -velocidadeBolaPosicaoY;
		}

		// Verificar se Jogador 2 fez ponto
		if (posicaoBolaX < 0) {
			if (posicaoBolaY > posicaoJogador1 && posicaoBolaY < posicaoJogador1 + alturaRaquete){
				// Rebate e a bola
				velocidadeBolaPosicaoX = -velocidadeBolaPosicaoX;

				var diferencaY = posicaoBolaY - (posicaoJogador1 + alturaRaquete / 2);
				velocidadeBolaPosicaoY = diferencaY * efeitoRaquete;
			} else {
			// Jogador 2 faz ponto
			jogador2 ++;

			// colocar a bola no centro
			continuar();
		}	
	}
		// Verifica se o Jogador 1 fez ponto
		if (posicaoBolaX > larguraCampo) {
			if (posicaoBolaY > posicaoJogador2 && posicaoBolaY < posicaoJogador2 + alturaRaquete){
			// Rebater a bola
			velocidadeBolaPosicaoX = -velocidadeBolaPosicaoX;
			var diferencaY = posicaoBolaY - (posicaoJogador2 + alturaRaquete / 2);
			velocidadeBolaPosicaoY = diferencaY * efeitoRaquete;
		} else {
			// Jogador 1 faz ponto 
			jogador1++;
			// colocar a bola no centro
			continuar();
		} 
	}	
		// Sincronização do computador com a bola.
		if (posicaoJogador2 + alturaRaquete / 2 < posicaoBolaY) {
			posicaoJogador2 = posicaoJogador2 + velocidadeJogador2;
		}else {
			posicaoJogador2 = posicaoJogador2 - velocidadeJogador2;
			
		} 
	}

	function principal () {
	desenhar ();
	calcular ();
}
</script>
</body>
</html>